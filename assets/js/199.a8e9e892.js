(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{633:function(e,t,a){"use strict";a.r(t);var v=a(2),s=Object(v.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"一、vite创建一个vue项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、vite创建一个vue项目"}},[e._v("#")]),e._v(" 一、vite创建一个Vue项目")]),e._v(" "),t("p",[e._v("yarn:")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("yarn")]),e._v(" create vite my-vue-app "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--template")]),e._v(" vue\n")])])]),t("p",[e._v("Npm:")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("// "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("6")]),e._v(".x\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" create vite@latest my-vue-app "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--template")]),e._v(" vue\n// "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("7")]),e._v(".x\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" create vite@latest my-vue-app -- "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--template")]),e._v(" vue\n")])])]),t("h2",{attrs:{id:"二、index-html-与项目根目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、index-html-与项目根目录"}},[e._v("#")]),e._v(" 二、index.html 与项目根目录")]),e._v(" "),t("p",[e._v("在一个 Vite 项目中，"),t("code",[e._v("index.html")]),e._v(" 在项目最外层而不是在 "),t("code",[e._v("public")]),e._v(" 文件夹内。这是有意而为之的：在开发期间 Vite 是一个服务器，而 "),t("code",[e._v("index.html")]),e._v(" 是该 Vite 项目的入口文件。")]),e._v(" "),t("p",[e._v("Vite 将 "),t("code",[e._v("index.html")]),e._v(" 视为源码和模块图的一部分。Vite 解析 "),t("code",[e._v('<script type="module" src="...">')]),e._v(" ，这个标签指向你的 JavaScript 源码。甚至内联引入 JavaScript 的 "),t("code",[e._v('<script type="module">')]),e._v(" 和引用 CSS 的 "),t("code",[e._v("<link href>")]),e._v(" 也能利用 Vite 特有的功能被解析。另外，"),t("code",[e._v("index.html")]),e._v(" 中的 URL 将被自动转换，因此不再需要 "),t("code",[e._v("%PUBLIC_URL%")]),e._v(" 占位符了。")]),e._v(" "),t("h2",{attrs:{id:"三、vite的功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、vite的功能"}},[e._v("#")]),e._v(" 三、vite的功能")]),e._v(" "),t("p",[e._v("Vite 还通过原生 ESM 导入提供了许多主要用于打包场景的增强功能。")]),e._v(" "),t("p",[e._v("Vite 在启动之前会创建一个为热更新服务定制的 websocket 服务器，然后对项目文件进行监听。同时客户端的 html 里注入了 @vite/client 来与服务端进行配合实现热更新。")]),e._v(" "),t("p",[e._v("Vite 在创建 WebSocketServer 时，主要进行了一些错误的捕获处理和对 payload 的格式处理，最终返回封装好的 send 和 close 方法，用于后续服务端推送消息和关闭服务。")]),e._v(" "),t("p",[e._v("vite的热更新流程：")]),e._v(" "),t("blockquote",[t("p",[e._v("1.生成并推送变更文件信息:两个核心操作，一个是更新 "),t("code",[e._v("moduleGraph")]),e._v("，使修改文件的缓存失效 ,一个是执行热更新方法 "),t("code",[e._v("handleHMRUpdate")]),e._v("。")]),e._v(" "),t("p",[e._v("2.客户端解析热更新信息，发送请求获取最新模块并渲染。")])]),e._v(" "),t("p",[e._v("Vite 的整个热更新并不涉及任何打包的操作，而是直接去请求获取了需要更新的模块的的内容，并完成模块的替换。这便是 Vite 项目中无论应用程序大小如何，都能够始终保持极快的模块热重载的秘诀，真正的实现了按需加载。")])])}),[],!1,null,null,null);t.default=s.exports}}]);