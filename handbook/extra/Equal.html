<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript专题之如何判断两个对象相等 | Jude&#39;s Vuepress</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.b03ac9b7.css" as="style"><link rel="preload" href="/assets/js/app.689a5ada.js" as="script"><link rel="preload" href="/assets/js/7.3a06637a.js" as="script"><link rel="preload" href="/assets/js/2.58cb2d11.js" as="script"><link rel="preload" href="/assets/js/1.aa9efe15.js" as="script"><link rel="preload" href="/assets/js/114.42b9b1c6.js" as="script"><link rel="prefetch" href="/assets/js/10.343458cc.js"><link rel="prefetch" href="/assets/js/100.53cc9378.js"><link rel="prefetch" href="/assets/js/101.6c22244f.js"><link rel="prefetch" href="/assets/js/102.a7dcfb1b.js"><link rel="prefetch" href="/assets/js/103.b625a760.js"><link rel="prefetch" href="/assets/js/104.9003cd2f.js"><link rel="prefetch" href="/assets/js/105.85ef3310.js"><link rel="prefetch" href="/assets/js/106.1bafc5ba.js"><link rel="prefetch" href="/assets/js/107.55d2c705.js"><link rel="prefetch" href="/assets/js/108.45c307d5.js"><link rel="prefetch" href="/assets/js/109.91940788.js"><link rel="prefetch" href="/assets/js/11.7eec24cc.js"><link rel="prefetch" href="/assets/js/110.950034fb.js"><link rel="prefetch" href="/assets/js/111.ba000f3a.js"><link rel="prefetch" href="/assets/js/112.80ff7617.js"><link rel="prefetch" href="/assets/js/113.679d63f8.js"><link rel="prefetch" href="/assets/js/115.79f787c8.js"><link rel="prefetch" href="/assets/js/116.fffabafa.js"><link rel="prefetch" href="/assets/js/117.2099350b.js"><link rel="prefetch" href="/assets/js/118.31064e67.js"><link rel="prefetch" href="/assets/js/119.8e1c15ef.js"><link rel="prefetch" href="/assets/js/120.a8a01761.js"><link rel="prefetch" href="/assets/js/121.6cd3bf9b.js"><link rel="prefetch" href="/assets/js/122.715f53d9.js"><link rel="prefetch" href="/assets/js/123.752f5f62.js"><link rel="prefetch" href="/assets/js/124.013fff7b.js"><link rel="prefetch" href="/assets/js/125.e6500c56.js"><link rel="prefetch" href="/assets/js/126.128ae206.js"><link rel="prefetch" href="/assets/js/127.185f50e3.js"><link rel="prefetch" href="/assets/js/128.f3b5212f.js"><link rel="prefetch" href="/assets/js/129.09b48696.js"><link rel="prefetch" href="/assets/js/130.26aca54b.js"><link rel="prefetch" href="/assets/js/131.f7c950a7.js"><link rel="prefetch" href="/assets/js/132.281d8a3e.js"><link rel="prefetch" href="/assets/js/133.5c125c45.js"><link rel="prefetch" href="/assets/js/134.d8435ea9.js"><link rel="prefetch" href="/assets/js/135.3989b6b3.js"><link rel="prefetch" href="/assets/js/136.aaca8c90.js"><link rel="prefetch" href="/assets/js/137.0aec7b5b.js"><link rel="prefetch" href="/assets/js/138.4b873e3e.js"><link rel="prefetch" href="/assets/js/139.511179cb.js"><link rel="prefetch" href="/assets/js/14.bf4c7c0f.js"><link rel="prefetch" href="/assets/js/140.18470a1c.js"><link rel="prefetch" href="/assets/js/141.afbe5e86.js"><link rel="prefetch" href="/assets/js/142.a5aa9f03.js"><link rel="prefetch" href="/assets/js/143.5e48ac1e.js"><link rel="prefetch" href="/assets/js/144.8fc30d20.js"><link rel="prefetch" href="/assets/js/145.38a8d8cc.js"><link rel="prefetch" href="/assets/js/146.92cc3ff5.js"><link rel="prefetch" href="/assets/js/147.8a42ea4b.js"><link rel="prefetch" href="/assets/js/148.05de950e.js"><link rel="prefetch" href="/assets/js/149.c5e19ddc.js"><link rel="prefetch" href="/assets/js/15.002e8c52.js"><link rel="prefetch" href="/assets/js/150.23c02fd4.js"><link rel="prefetch" href="/assets/js/151.8385d5b2.js"><link rel="prefetch" href="/assets/js/152.914a982f.js"><link rel="prefetch" href="/assets/js/153.1e05a0ba.js"><link rel="prefetch" href="/assets/js/154.7eb1b2b5.js"><link rel="prefetch" href="/assets/js/155.c36ad5c0.js"><link rel="prefetch" href="/assets/js/156.efc21504.js"><link rel="prefetch" href="/assets/js/157.1df258e3.js"><link rel="prefetch" href="/assets/js/158.d20706b3.js"><link rel="prefetch" href="/assets/js/159.2ac5aca4.js"><link rel="prefetch" href="/assets/js/16.593091b2.js"><link rel="prefetch" href="/assets/js/160.2bb5c411.js"><link rel="prefetch" href="/assets/js/161.4f7425fd.js"><link rel="prefetch" href="/assets/js/162.039900ff.js"><link rel="prefetch" href="/assets/js/163.de56af7b.js"><link rel="prefetch" href="/assets/js/164.862251ce.js"><link rel="prefetch" href="/assets/js/165.1732b824.js"><link rel="prefetch" href="/assets/js/166.ee9b0aba.js"><link rel="prefetch" href="/assets/js/167.0cdfc7b9.js"><link rel="prefetch" href="/assets/js/168.b5e42bf5.js"><link rel="prefetch" href="/assets/js/169.76455951.js"><link rel="prefetch" href="/assets/js/17.636516b2.js"><link rel="prefetch" href="/assets/js/170.0eeeb50e.js"><link rel="prefetch" href="/assets/js/171.979493bd.js"><link rel="prefetch" href="/assets/js/172.47b449de.js"><link rel="prefetch" href="/assets/js/173.2b80d2ee.js"><link rel="prefetch" href="/assets/js/174.26ad1619.js"><link rel="prefetch" href="/assets/js/175.ccda9909.js"><link rel="prefetch" href="/assets/js/176.19164e56.js"><link rel="prefetch" href="/assets/js/177.cdeffcc5.js"><link rel="prefetch" href="/assets/js/178.b31885da.js"><link rel="prefetch" href="/assets/js/179.b3a10a45.js"><link rel="prefetch" href="/assets/js/18.4fde6aa6.js"><link rel="prefetch" href="/assets/js/180.0e1d85d2.js"><link rel="prefetch" href="/assets/js/181.7be8ffd4.js"><link rel="prefetch" href="/assets/js/182.9d7a97e6.js"><link rel="prefetch" href="/assets/js/183.96fcf3db.js"><link rel="prefetch" href="/assets/js/184.cb25746a.js"><link rel="prefetch" href="/assets/js/185.163820eb.js"><link rel="prefetch" href="/assets/js/186.73f7e80e.js"><link rel="prefetch" href="/assets/js/187.736929cc.js"><link rel="prefetch" href="/assets/js/188.c2925c4b.js"><link rel="prefetch" href="/assets/js/189.0681f7df.js"><link rel="prefetch" href="/assets/js/19.aaad38ea.js"><link rel="prefetch" href="/assets/js/190.e37e9e1c.js"><link rel="prefetch" href="/assets/js/191.983b05ee.js"><link rel="prefetch" href="/assets/js/192.b66075eb.js"><link rel="prefetch" href="/assets/js/193.98554bbd.js"><link rel="prefetch" href="/assets/js/194.a803c35b.js"><link rel="prefetch" href="/assets/js/195.54009d77.js"><link rel="prefetch" href="/assets/js/196.c1e3cffa.js"><link rel="prefetch" href="/assets/js/197.6fe5bfdf.js"><link rel="prefetch" href="/assets/js/198.f21b3393.js"><link rel="prefetch" href="/assets/js/199.a8e9e892.js"><link rel="prefetch" href="/assets/js/20.8ab51987.js"><link rel="prefetch" href="/assets/js/200.75d2b54c.js"><link rel="prefetch" href="/assets/js/201.995eaeb5.js"><link rel="prefetch" href="/assets/js/202.ad76a453.js"><link rel="prefetch" href="/assets/js/203.9946d113.js"><link rel="prefetch" href="/assets/js/204.bca67ea2.js"><link rel="prefetch" href="/assets/js/205.8f513b38.js"><link rel="prefetch" href="/assets/js/206.b6c1f50b.js"><link rel="prefetch" href="/assets/js/207.6f752af9.js"><link rel="prefetch" href="/assets/js/208.f1a7a916.js"><link rel="prefetch" href="/assets/js/209.8f055b32.js"><link rel="prefetch" href="/assets/js/21.fe260051.js"><link rel="prefetch" href="/assets/js/22.93c6ab57.js"><link rel="prefetch" href="/assets/js/23.c038909a.js"><link rel="prefetch" href="/assets/js/24.0763c5bb.js"><link rel="prefetch" href="/assets/js/25.2cde3652.js"><link rel="prefetch" href="/assets/js/26.ae01fb26.js"><link rel="prefetch" href="/assets/js/27.1a8e14f7.js"><link rel="prefetch" href="/assets/js/28.4ee860ba.js"><link rel="prefetch" href="/assets/js/29.3baf33d6.js"><link rel="prefetch" href="/assets/js/3.37cf9a06.js"><link rel="prefetch" href="/assets/js/30.ac4a86d1.js"><link rel="prefetch" href="/assets/js/31.fcb1139b.js"><link rel="prefetch" href="/assets/js/32.a35bce04.js"><link rel="prefetch" href="/assets/js/33.5c11060e.js"><link rel="prefetch" href="/assets/js/34.451797f4.js"><link rel="prefetch" href="/assets/js/35.74e12899.js"><link rel="prefetch" href="/assets/js/36.52cf6bc5.js"><link rel="prefetch" href="/assets/js/37.46e68287.js"><link rel="prefetch" href="/assets/js/38.244cd8a5.js"><link rel="prefetch" href="/assets/js/39.d41db969.js"><link rel="prefetch" href="/assets/js/4.a6acfbc8.js"><link rel="prefetch" href="/assets/js/40.238a45a2.js"><link rel="prefetch" href="/assets/js/41.b5f27aee.js"><link rel="prefetch" href="/assets/js/42.2bd167d6.js"><link rel="prefetch" href="/assets/js/43.d280cf12.js"><link rel="prefetch" href="/assets/js/44.f0ce6b7f.js"><link rel="prefetch" href="/assets/js/45.52196381.js"><link rel="prefetch" href="/assets/js/46.91f89126.js"><link rel="prefetch" href="/assets/js/47.cc6b4370.js"><link rel="prefetch" href="/assets/js/48.bea9b9d4.js"><link rel="prefetch" href="/assets/js/49.da7338ad.js"><link rel="prefetch" href="/assets/js/5.36f07d8d.js"><link rel="prefetch" href="/assets/js/50.81241ea5.js"><link rel="prefetch" href="/assets/js/51.1897443d.js"><link rel="prefetch" href="/assets/js/52.b14b9535.js"><link rel="prefetch" href="/assets/js/53.9ed303cf.js"><link rel="prefetch" href="/assets/js/54.7d3dafee.js"><link rel="prefetch" href="/assets/js/55.08c8ac33.js"><link rel="prefetch" href="/assets/js/56.2a0037fe.js"><link rel="prefetch" href="/assets/js/57.6c8e1dfb.js"><link rel="prefetch" href="/assets/js/58.90c49ddd.js"><link rel="prefetch" href="/assets/js/59.d25bdcd1.js"><link rel="prefetch" href="/assets/js/6.8a9deb6f.js"><link rel="prefetch" href="/assets/js/60.826fc2c1.js"><link rel="prefetch" href="/assets/js/61.ce93892d.js"><link rel="prefetch" href="/assets/js/62.734fca4c.js"><link rel="prefetch" href="/assets/js/63.b3cd5bb1.js"><link rel="prefetch" href="/assets/js/64.3689c19d.js"><link rel="prefetch" href="/assets/js/65.26167cdd.js"><link rel="prefetch" href="/assets/js/66.48498fb4.js"><link rel="prefetch" href="/assets/js/67.630a5e43.js"><link rel="prefetch" href="/assets/js/68.0f85bdb5.js"><link rel="prefetch" href="/assets/js/69.2830014a.js"><link rel="prefetch" href="/assets/js/70.73300633.js"><link rel="prefetch" href="/assets/js/71.294022ca.js"><link rel="prefetch" href="/assets/js/72.e2c119c7.js"><link rel="prefetch" href="/assets/js/73.e21c9b05.js"><link rel="prefetch" href="/assets/js/74.c031fc99.js"><link rel="prefetch" href="/assets/js/75.f4a50645.js"><link rel="prefetch" href="/assets/js/76.43193dc3.js"><link rel="prefetch" href="/assets/js/77.fa926d83.js"><link rel="prefetch" href="/assets/js/78.4a7fb56e.js"><link rel="prefetch" href="/assets/js/79.17dd5d20.js"><link rel="prefetch" href="/assets/js/8.044d81f3.js"><link rel="prefetch" href="/assets/js/80.f9f95a45.js"><link rel="prefetch" href="/assets/js/81.576504a5.js"><link rel="prefetch" href="/assets/js/82.76c14100.js"><link rel="prefetch" href="/assets/js/83.29e414e0.js"><link rel="prefetch" href="/assets/js/84.cdb2db5f.js"><link rel="prefetch" href="/assets/js/85.5ab72d57.js"><link rel="prefetch" href="/assets/js/86.8f8d2adf.js"><link rel="prefetch" href="/assets/js/87.4fa59535.js"><link rel="prefetch" href="/assets/js/88.17cc86d9.js"><link rel="prefetch" href="/assets/js/89.af743c9b.js"><link rel="prefetch" href="/assets/js/9.241b4fed.js"><link rel="prefetch" href="/assets/js/90.5c72409a.js"><link rel="prefetch" href="/assets/js/91.4772e44a.js"><link rel="prefetch" href="/assets/js/92.eeb0a86b.js"><link rel="prefetch" href="/assets/js/93.4fc530c5.js"><link rel="prefetch" href="/assets/js/94.2ba04fbd.js"><link rel="prefetch" href="/assets/js/95.f01c5c88.js"><link rel="prefetch" href="/assets/js/96.53eb17bf.js"><link rel="prefetch" href="/assets/js/97.21d34f53.js"><link rel="prefetch" href="/assets/js/98.ae72aed4.js"><link rel="prefetch" href="/assets/js/99.8f0071c0.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5cd4fb0d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b03ac9b7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Jude's Vuepress</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/bg.2cfdbb33.svg" alt="Jude's Vuepress" class="logo"> <span class="site-name">Jude's Vuepress</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="https://cn.vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Vue.js
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://python.langchain.com/docs/introduction/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  LLM-LangChain
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Jude's Github
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://vueuse.org/guide/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  VueUse
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/judeyq" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>98</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="https://cn.vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Vue.js
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://python.langchain.com/docs/introduction/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  LLM-LangChain
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Jude's Github
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://vueuse.org/guide/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  VueUse
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/judeyq" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/" class="sidebar-heading clickable router-link-active"><span>Home</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">文档内容</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/es6/1" class="sidebar-heading clickable"><span>ES6教程-阮一峰</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/webrtc/1" class="sidebar-heading clickable"><span>WebRTC</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/js/Closure" class="sidebar-heading clickable open"><span>JavaScript</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/handbook/js/Closure.html" class="sidebar-link">JavaScript-闭包</a></li><li><a href="/handbook/js/Variable.html" class="sidebar-link">JavaScript-变量对象</a></li><li><a href="/handbook/js/Params.html" class="sidebar-link">JavaScript-参数按值传递</a></li><li><a href="/handbook/js/Create.html" class="sidebar-link">JavaScript-创建对象方式及优缺点</a></li><li><a href="/handbook/js/Scope.html" class="sidebar-link">JavaScript-词法作用域和动态作用域</a></li><li><a href="/handbook/js/Prototype.html" class="sidebar-link">JavaScript-原型到原型链</a></li><li><a href="/handbook/js/This.html" class="sidebar-link">JavaScript-ECMA规范解读this</a></li><li><a href="/handbook/js/Inherit.html" class="sidebar-link">JavaScript-继承的多种方式及优缺点</a></li><li><a href="/handbook/js/Arguments.html" class="sidebar-link">JavaScript-类数组对象与arguments</a></li><li><a href="/handbook/js/Executable.html" class="sidebar-link">JavaScript-执行上下文</a></li><li><a href="/handbook/js/ExecutableStack.html" class="sidebar-link">JavaScript-执行上下文栈</a></li><li><a href="/handbook/js/Exescope.html" class="sidebar-link">JavaScript-作用域链</a></li><li><a href="/handbook/js/Bind.html" class="sidebar-link">JavaScript-实现bind</a></li><li><a href="/handbook/js/Apply.html" class="sidebar-link">JavaScript-实现call和apply</a></li><li><a href="/handbook/js/New.html" class="sidebar-link">JavaScript-实现new</a></li><li><a href="/handbook/extra/Compose.html" class="sidebar-link">JavaScript-函数组合</a></li><li><a href="/handbook/extra/Copy.html" class="sidebar-link">JavaScript-深浅拷贝</a></li><li><a href="/handbook/extra/Currying.html" class="sidebar-link">JavaScript-柯里化</a></li><li><a href="/handbook/extra/Debounce.html" class="sidebar-link">JavaScript-防抖</a></li><li><a href="/handbook/extra/Disorder.html" class="sidebar-link">JavaScript-乱序</a></li><li><a href="/handbook/extra/Duplicate.html" class="sidebar-link">JavaScript-数组去重</a></li><li><a href="/handbook/extra/Each.html" class="sidebar-link">JavaScript-实现jQuery通用遍历方法each</a></li><li><a href="/handbook/extra/Equal.html" aria-current="page" class="active sidebar-link">JavaScript-判断两个对象相等</a></li><li><a href="/handbook/extra/Extend.html" class="sidebar-link">JavaScript-实现jQuery的extend</a></li><li><a href="/handbook/extra/Find.html" class="sidebar-link">JavaScript-underscore在数组中查找指定元素</a></li><li><a href="/handbook/extra/Flatten.html" class="sidebar-link">JavaScript-数组扁平化</a></li><li><a href="/handbook/extra/Inertiafunction.html" class="sidebar-link">JavaScript-惰性函数</a></li><li><a href="/handbook/extra/Max.html" class="sidebar-link">JavaScript-如何求数组的最大值和最小值</a></li><li><a href="/handbook/extra/Memory.html" class="sidebar-link">JavaScript-函数记忆</a></li><li><a href="/handbook/extra/Partial.html" class="sidebar-link">JavaScript-偏函数</a></li><li><a href="/handbook/extra/Recursion.html" class="sidebar-link">JavaScript-递归</a></li><li><a href="/handbook/extra/Throttle.html" class="sidebar-link">JavaScript-节流</a></li><li><a href="/handbook/extra/Typeofone.html" class="sidebar-link">JavaScript-类型判断上</a></li><li><a href="/handbook/extra/Typeoftwo.html" class="sidebar-link">JavaScript-类型判断下</a></li><li><a href="/handbook/extra/V8.html" class="sidebar-link">JavaScript-V8排序源码</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/ele/1" class="sidebar-heading clickable"><span>Vue3后台管理系统element-plus</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/vue/1" class="sidebar-heading clickable"><span>Vue</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/go/1" class="sidebar-heading clickable"><span>Golang</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/react/1" class="sidebar-heading clickable"><span>React</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/handbook/chain/1" class="sidebar-heading clickable"><span>LLM大语言模型应用-LangChain</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">JavaScript专题之如何判断两个对象相等</h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="javascript专题之如何判断两个对象相等"><a href="#javascript专题之如何判断两个对象相等" class="header-anchor">#</a> JavaScript专题之如何判断两个对象相等</h1> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>虽然标题写的是如何判断两个对象相等，但本篇我们不仅仅判断两个对象相等，实际上，我们要做到的是如何判断两个参数相等，而这必然会涉及到多种类型的判断。</p> <h2 id="相等"><a href="#相等" class="header-anchor">#</a> 相等</h2> <p>什么是相等？在<a href="https://github.com/mqyqingfeng/Blog/issues/27" target="_blank" rel="noopener noreferrer">《JavaScript专题之去重》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中，我们认为只要 <code>===</code> 的结果为 true，两者就相等，然而今天我们重新定义相等：</p> <p>我们认为：</p> <ol><li>NaN 和 NaN 是相等</li> <li>[1] 和 [1] 是相等</li> <li>{value: 1} 和 {value: 1} 是相等</li></ol> <p>不仅仅是这些长得一样的，还有</p> <ol><li>1 和 new Number(1) 是相等</li> <li>'Curly' 和 new String('Curly') 是相等</li> <li>true 和 new Boolean(true) 是相等</li></ol> <p>更复杂的我们会在接下来的内容中看到。</p> <h2 id="目标"><a href="#目标" class="header-anchor">#</a> 目标</h2> <p>我们的目标是写一个 eq 函数用来判断两个参数是否相等，使用效果如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>在写这个看似很简单的函数之前，我们首先了解在一些简单的情况下是如何判断的？</p> <h2 id="_0-与-0"><a href="#_0-与-0" class="header-anchor">#</a> +0 与 -0</h2> <p>如果 a === b 的结果为 true， 那么 a 和 b 就是相等的吗？一般情况下，当然是这样的，但是有一个特殊的例子，就是 +0 和 -0。</p> <p>JavaScript “处心积虑”的想抹平两者的差异：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 表现1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">0</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// 表现2</span>
<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// '0'</span>
<span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// '0'</span>

<span class="token comment">// 表现3</span>
<span class="token operator">-</span><span class="token number">0</span> <span class="token operator">&lt;</span> <span class="token operator">+</span><span class="token number">0</span> <span class="token comment">// false</span>
<span class="token operator">+</span><span class="token number">0</span> <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">0</span> <span class="token comment">// false</span>
</code></pre></div><p>即便如此，两者依然是不同的：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">/</span> <span class="token operator">+</span><span class="token number">0</span> <span class="token comment">// Infinity</span>
<span class="token number">1</span> <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">0</span> <span class="token comment">// -Infinity</span>

<span class="token number">1</span> <span class="token operator">/</span> <span class="token operator">+</span><span class="token number">0</span> <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">0</span> <span class="token comment">// false</span>
</code></pre></div><p>也许你会好奇为什么要有 +0 和 -0 呢？</p> <p>这是因为 JavaScript 采用了IEEE_754 浮点数表示法(几乎所有现代编程语言所采用)，这是一种二进制表示法，按照这个标准，最高位是符号位(0 代表正，1 代表负)，剩下的用于表示大小。而对于零这个边界值 ，1000(-0) 和 0000(0)都是表示 0 ，这才有了正负零的区别。</p> <p>也许你会好奇什么时候会产生 -0 呢？</p> <div class="language-js extra-class"><pre class="language-js"><code>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token comment">// -0</span>
</code></pre></div><p>那么我们又该如何在 === 结果为 true 的时候，区别 0 和 -0 得出正确的结果呢？我们可以这样做：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> a <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">/</span> a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> b<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><h2 id="nan"><a href="#nan" class="header-anchor">#</a> NaN</h2> <p>在本篇，我们认为 NaN 和 NaN 是相等的，那又该如何判断出 NaN 呢？</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">NaN</span> <span class="token operator">===</span> <span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><p>利用 NaN 不等于自身的特性，我们可以区别出 NaN，那么这个 eq 函数又该怎么写呢？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!==</span> a<span class="token punctuation">)</span> <span class="token keyword">return</span> b <span class="token operator">!==</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h2 id="eq-函数"><a href="#eq-函数" class="header-anchor">#</a> eq 函数</h2> <p>现在，我们已经可以去写 eq 函数的第一版了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// eq 第一版</span>
<span class="token comment">// 用来过滤掉简单的类型比较，复杂的对象使用 deepEq 函数进行处理</span>
<span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// === 结果为 true 的区别出 +0 和 -0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> a <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">/</span> a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> b<span class="token punctuation">;</span>

    <span class="token comment">// typeof null 的结果为 object ，这里做判断，是为了让有 null 的情况尽早退出函数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> b <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token comment">// 判断 NaN</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!==</span> a<span class="token punctuation">)</span> <span class="token keyword">return</span> b <span class="token operator">!==</span> b<span class="token punctuation">;</span>

    <span class="token comment">// 判断参数 a 类型，如果是基本类型，在这里可以直接返回 false</span>
    <span class="token keyword">var</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> a<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> b <span class="token operator">!=</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token comment">// 更复杂的对象使用 deepEq 函数进行深度比较</span>
    <span class="token keyword">return</span> <span class="token function">deepEq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>也许你会好奇是不是少了一个 <code>typeof b !== function</code>?</p> <p>试想如果我们添加上了这句，当 a 是基本类型，而 b 是函数的时候，就会进入 deepEq 函数，而去掉这一句，就会进入直接进入 false，实际上 基本类型和函数肯定是不会相等的，所以这样做代码又少，又可以让一种情况更早退出。</p> <h2 id="string-对象"><a href="#string-对象" class="header-anchor">#</a> String 对象</h2> <p>现在我们开始写 deepEq 函数，一个要处理的重大难题就是 'Curly' 和 new String('Curly') 如何判断成相等？</p> <p>两者的类型都不一样呐！不信我们看 typeof 的操作结果：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token string">'Curly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'Curly'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// object</span>
</code></pre></div><p>可是我们在<a href="https://github.com/mqyqingfeng/Blog/issues/28" target="_blank" rel="noopener noreferrer">《JavaScript专题之类型判断上》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中还学习过更多的方法判断类型，比如 Object.prototype.toString：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> toString <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>
<span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'Curly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object String]&quot;</span>
<span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'Curly'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object String]&quot;</span>
</code></pre></div><p>神奇的是使用 toString 方法两者判断的结果却是一致的，可是就算知道了这一点，还是不知道如何判断字符串和字符串包装对象是相等的呢？</p> <p>那我们利用隐式类型转换呢？</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Curly'</span> <span class="token operator">+</span> <span class="token string">''</span> <span class="token operator">===</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'Curly'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>看来我们已经有了思路：如果 a 和 b 的 Object.prototype.toString的结果一致，并且都是&quot;[object String]&quot;，那我们就使用 '' + a === '' + b 进行判断。</p> <p>可是不止有 String 对象呐，Boolean、Number、RegExp、Date呢？</p> <h2 id="更多对象"><a href="#更多对象" class="header-anchor">#</a> 更多对象</h2> <p>跟 String 同样的思路，利用隐式类型转换。</p> <p><strong>Boolean</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p><strong>Date</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">2009</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">2009</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p><strong>RegExp</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">''</span> <span class="token operator">+</span> a <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p><strong>Number</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>嗯哼？你确定 Number 能这么简单的判断？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><p>可是 a 和 b 应该被判断成 true 的呐~</p> <p>那么我们就改成这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断 Number(NaN) Object(NaN) 等情况</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">!==</span> <span class="token operator">+</span>a<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">+</span>b <span class="token operator">!==</span> <span class="token operator">+</span>b<span class="token punctuation">;</span>
    <span class="token comment">// 其他判断 ...</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h2 id="deepeq-函数"><a href="#deepeq-函数" class="header-anchor">#</a> deepEq 函数</h2> <p>现在我们可以写一点 deepEq 函数了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> toString <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> className <span class="token operator">=</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>className <span class="token operator">!==</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>className<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'[object RegExp]'</span><span class="token operator">:</span>
        <span class="token keyword">case</span> <span class="token string">'[object String]'</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">''</span> <span class="token operator">+</span> a <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'[object Number]'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">!==</span> <span class="token operator">+</span>a<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">+</span>b <span class="token operator">!==</span> <span class="token operator">+</span>b<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> b <span class="token operator">:</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'[object Date]'</span><span class="token operator">:</span>
      <span class="token keyword">case</span> <span class="token string">'[object Boolean]'</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 其他判断</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="构造函数实例"><a href="#构造函数实例" class="header-anchor">#</a> 构造函数实例</h2> <p>我们看个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Kevin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> animal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">'Kevin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">eq</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> animal<span class="token punctuation">)</span> <span class="token comment">// ???</span>
</code></pre></div><p>虽然 <code>person</code> 和 <code>animal</code> 都是 <code>{name: 'Kevin'}</code>，但是 <code>person</code> 和 <code>animal</code> 属于不同构造函数的实例，为了做出区分，我们认为是不同的对象。</p> <p>如果两个对象所属的构造函数对象不同，两个对象就一定不相等吗？</p> <p>并不一定，我们再举个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> attrs <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
attrs<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">;</span>
<span class="token function">eq</span><span class="token punctuation">(</span>attrs<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ???</span>
</code></pre></div><p>尽管 <code>attrs</code> 没有原型，<code>{name: &quot;Bob&quot;}</code> 的构造函数是 <code>Object</code>，但是在实际应用中，只要他们有着相同的键值对，我们依然认为是相等。</p> <p>从函数设计的角度来看，我们不应该让他们相等，但是从实践的角度，我们让他们相等，所以相等就是一件如此随意的事情吗？！对啊，我也在想：undersocre，你怎么能如此随意呢！！！</p> <p>哎，吐槽完了，我们还是要接着写这个相等函数，我们可以先做个判断，对于不同构造函数下的实例直接返回 false。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isFunction</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Function]'</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 接着上面的内容</span>
    <span class="token keyword">var</span> areArrays <span class="token operator">=</span> className <span class="token operator">===</span> <span class="token string">'[object Array]'</span><span class="token punctuation">;</span>
    <span class="token comment">// 不是数组</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>areArrays<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 过滤掉两个函数的情况</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> b <span class="token operator">!=</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> aCtor <span class="token operator">=</span> a<span class="token punctuation">.</span>constructor<span class="token punctuation">,</span> bCtor <span class="token operator">=</span> b<span class="token punctuation">.</span>constructor<span class="token punctuation">;</span>
        <span class="token comment">// aCtor 和 bCtor 必须都存在并且都不是 Object 构造函数的情况下，aCtor 不等于 bCtor， 那这两个对象就真的不相等啦</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aCtor <span class="token operator">==</span> bCtor <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>aCtor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> aCtor <span class="token keyword">instanceof</span> <span class="token class-name">aCtor</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isFunction</span><span class="token punctuation">(</span>bCtor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> bCtor <span class="token keyword">instanceof</span> <span class="token class-name">bCtor</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token string">'constructor'</span> <span class="token keyword">in</span> a <span class="token operator">&amp;&amp;</span> <span class="token string">'constructor'</span> <span class="token keyword">in</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 下面还有好多判断</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="数组相等"><a href="#数组相等" class="header-anchor">#</a> 数组相等</h2> <p>现在终于可以进入我们期待已久的数组和对象的判断，不过其实这个很简单，就是递归遍历一遍……</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 再接着上面的内容</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>areArrays<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        length <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">!==</span> b<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> 
    <span class="token keyword">else</span> <span class="token punctuation">{</span>

        <span class="token keyword">var</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">;</span>
        length <span class="token operator">=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">!==</span> length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            key <span class="token operator">=</span> keys<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="循环引用"><a href="#循环引用" class="header-anchor">#</a> 循环引用</h2> <p>如果觉得这就结束了，简直是太天真，因为最难的部分才终于要开始，这个问题就是循环引用！</p> <p>举个简单的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code>a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">abc</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">abc</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>abc <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>abc <span class="token operator">=</span> b<span class="token punctuation">;</span>

<span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
</code></pre></div><p>再复杂一点的，比如：</p> <div class="language-js extra-class"><pre class="language-js"><code>a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> b<span class="token punctuation">;</span>

<span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
</code></pre></div><p>为了给大家演示下循环引用，大家可以把下面这段已经精简过的代码复制到浏览器中尝试：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// demo</span>
<span class="token keyword">var</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>

a <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> b<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">==</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">===</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">deepEq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> length <span class="token operator">=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> key<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        key <span class="token operator">=</span> keys<span class="token punctuation">[</span>length<span class="token punctuation">]</span>

        <span class="token comment">// 这是为了让你看到代码其实一直在执行</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
</code></pre></div><p>嗯，以上的代码是死循环。</p> <p>那么，我们又该如何解决这个问题呢？underscore 的思路是 eq 的时候，多传递两个参数为 aStack 和 bStack，用来储存 a 和 b 递归比较过程中的 a 和 b 的值，咋说的这么绕口呢？
我们直接看个精简的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>

a <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> b<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">==</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">===</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">deepEq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    aStack <span class="token operator">=</span> aStack <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    bStack <span class="token operator">=</span> bStack <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> length <span class="token operator">=</span> aStack<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aStack<span class="token punctuation">[</span>length<span class="token punctuation">]</span> <span class="token operator">===</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> bStack<span class="token punctuation">[</span>length<span class="token punctuation">]</span> <span class="token operator">===</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    aStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    bStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> length <span class="token operator">=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> key<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        key <span class="token operator">=</span> keys<span class="token punctuation">[</span>length<span class="token punctuation">]</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// aStack.pop();</span>
    <span class="token comment">// bStack.pop();</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>之所以注释掉 <code>aStack.pop()</code>和<code>bStack.pop()</code>这两句，是为了方便大家查看 aStack bStack的值。</p> <h2 id="最终的-eq-函数"><a href="#最终的-eq-函数" class="header-anchor">#</a> 最终的 eq 函数</h2> <p>最终的代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> toString <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">isFunction</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Function]'</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// === 结果为 true 的区别出 +0 和 -0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> a <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">/</span> a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> b<span class="token punctuation">;</span>

    <span class="token comment">// typeof null 的结果为 object ，这里做判断，是为了让有 null 的情况尽早退出函数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> b <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token comment">// 判断 NaN</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!==</span> a<span class="token punctuation">)</span> <span class="token keyword">return</span> b <span class="token operator">!==</span> b<span class="token punctuation">;</span>

    <span class="token comment">// 判断参数 a 类型，如果是基本类型，在这里可以直接返回 false</span>
    <span class="token keyword">var</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> a<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> b <span class="token operator">!=</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token comment">// 更复杂的对象使用 deepEq 函数进行深度比较</span>
    <span class="token keyword">return</span> <span class="token function">deepEq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// a 和 b 的内部属性 [[class]] 相同时 返回 true</span>
    <span class="token keyword">var</span> className <span class="token operator">=</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>className <span class="token operator">!==</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>className<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'[object RegExp]'</span><span class="token operator">:</span>
        <span class="token keyword">case</span> <span class="token string">'[object String]'</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">''</span> <span class="token operator">+</span> a <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'[object Number]'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">!==</span> <span class="token operator">+</span>a<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">+</span>b <span class="token operator">!==</span> <span class="token operator">+</span>b<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> b <span class="token operator">:</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'[object Date]'</span><span class="token operator">:</span>
        <span class="token keyword">case</span> <span class="token string">'[object Boolean]'</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> areArrays <span class="token operator">=</span> className <span class="token operator">===</span> <span class="token string">'[object Array]'</span><span class="token punctuation">;</span>
    <span class="token comment">// 不是数组</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>areArrays<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 过滤掉两个函数的情况</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> b <span class="token operator">!=</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> aCtor <span class="token operator">=</span> a<span class="token punctuation">.</span>constructor<span class="token punctuation">,</span>
            bCtor <span class="token operator">=</span> b<span class="token punctuation">.</span>constructor<span class="token punctuation">;</span>
        <span class="token comment">// aCtor 和 bCtor 必须都存在并且都不是 Object 构造函数的情况下，aCtor 不等于 bCtor， 那这两个对象就真的不相等啦</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aCtor <span class="token operator">==</span> bCtor <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>aCtor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> aCtor <span class="token keyword">instanceof</span> <span class="token class-name">aCtor</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isFunction</span><span class="token punctuation">(</span>bCtor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> bCtor <span class="token keyword">instanceof</span> <span class="token class-name">bCtor</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token string">'constructor'</span> <span class="token keyword">in</span> a <span class="token operator">&amp;&amp;</span> <span class="token string">'constructor'</span> <span class="token keyword">in</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    aStack <span class="token operator">=</span> aStack <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    bStack <span class="token operator">=</span> bStack <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> length <span class="token operator">=</span> aStack<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token comment">// 检查是否有循环引用的部分</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aStack<span class="token punctuation">[</span>length<span class="token punctuation">]</span> <span class="token operator">===</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> bStack<span class="token punctuation">[</span>length<span class="token punctuation">]</span> <span class="token operator">===</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    aStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    bStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 数组判断</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>areArrays<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        length <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">!==</span> b<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 对象判断</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>

        <span class="token keyword">var</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>
            key<span class="token punctuation">;</span>
        length <span class="token operator">=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">!==</span> length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            key <span class="token operator">=</span> keys<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    aStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">'Curly'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'Curly'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">var</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>

a <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>b<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>c<span class="token punctuation">.</span>foo <span class="token operator">=</span> b<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>真让人感叹一句：eq 不愧是 underscore 中实现代码行数最多的函数了！</p> <h2 id="专题系列"><a href="#专题系列" class="header-anchor">#</a> 专题系列</h2> <p>JavaScript专题系列目录地址：<a href="https://github.com/mqyqingfeng/Blog" target="_blank" rel="noopener noreferrer">https://github.com/mqyqingfeng/Blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>JavaScript专题系列预计写二十篇左右，主要研究日常开发中一些功能点的实现，比如防抖、节流、去重、类型判断、拷贝、最值、扁平、柯里、递归、乱序、排序等，特点是研(chao)究(xi) underscore 和 jQuery 的实现方式。</p> <p>如果有错误或者不严谨的地方，请务必给予指正，十分感谢。如果喜欢或者有所启发，欢迎 star，对作者也是一种鼓励。</p></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/handbook/extra/Each.html" class="prev">
          JavaScript-实现jQuery通用遍历方法each
        </a></span> <span class="next"><a href="/handbook/extra/Extend.html">
          JavaScript-实现jQuery的extend
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#前言" class="sidebar-link reco-side-前言" data-v-b57cc07c>前言</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#相等" class="sidebar-link reco-side-相等" data-v-b57cc07c>相等</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#目标" class="sidebar-link reco-side-目标" data-v-b57cc07c>目标</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#_0-与-0" class="sidebar-link reco-side-_0-与-0" data-v-b57cc07c>+0 与 -0</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#nan" class="sidebar-link reco-side-nan" data-v-b57cc07c>NaN</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#eq-函数" class="sidebar-link reco-side-eq-函数" data-v-b57cc07c>eq 函数</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#string-对象" class="sidebar-link reco-side-string-对象" data-v-b57cc07c>String 对象</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#更多对象" class="sidebar-link reco-side-更多对象" data-v-b57cc07c>更多对象</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#deepeq-函数" class="sidebar-link reco-side-deepeq-函数" data-v-b57cc07c>deepEq 函数</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#构造函数实例" class="sidebar-link reco-side-构造函数实例" data-v-b57cc07c>构造函数实例</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#数组相等" class="sidebar-link reco-side-数组相等" data-v-b57cc07c>数组相等</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#循环引用" class="sidebar-link reco-side-循环引用" data-v-b57cc07c>循环引用</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#最终的-eq-函数" class="sidebar-link reco-side-最终的-eq-函数" data-v-b57cc07c>最终的 eq 函数</a></li><li class="level-2" data-v-b57cc07c><a href="/handbook/extra/Equal.html#专题系列" class="sidebar-link reco-side-专题系列" data-v-b57cc07c>专题系列</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.689a5ada.js" defer></script><script src="/assets/js/7.3a06637a.js" defer></script><script src="/assets/js/2.58cb2d11.js" defer></script><script src="/assets/js/1.aa9efe15.js" defer></script><script src="/assets/js/114.42b9b1c6.js" defer></script>
  </body>
</html>
